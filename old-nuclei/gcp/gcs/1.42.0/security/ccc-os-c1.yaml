id: ccc-os-c1
info:
  name: Prevent unencrypted requests to object storage bucket
  severity: info
  author: FINOS

self-contained: true

code:
  - engine:
      - zsh
    source: |
      ~/dev/nuclei-demo/bin/gcp/gcs/gcs-1.42.0 GCS_CCC_OS_C1_TR01

    extractors:
      - type: regex
        regex:
          - "FAIL"

    matchers:
      - type: word
        words:
          - "ERROR"

  - engine:
      - zsh
    source: |
      ~/dev/nuclei-demo/bin/gcp/gcs/gcs-1.42.0 GCS_CCC_OS_C1_TR02

    extractors:
      - type: regex
        regex:
          - "FAIL"

    matchers:
      - type: word
        words:
          - "ERROR"

  - engine:
      - zsh
    source: |
      ~/dev/nuclei-demo/bin/gcp/gcs/gcs-1.42.0 GCS_CCC_OS_C1_TR03

    extractors:
      - type: regex
        regex:
          - "FAIL"

    matchers:
      - type: word
        words:
          - "ERROR"
# digest: 4a0a0047304502202a8c52a6b8b596eb32285ec51531ab9e5a253f6c4aaa03d873525edea9f46e90022100a3de6c14f0e7c66c8fe2649947603bbe8367f263d1c0f50c44aaa01433f9c6ac:aaf38f31a171ac3523192a918c72ba84